(self.webpackChunkwebnovel_pc=self.webpackChunkwebnovel_pc||[]).push([[1847],{3309:(e,t,a)=>{"use strict";a.d(t,{Z:()=>p});var r=a(7113),i=a.n(r),o=a(6708),n=a(4102),s=a(9209),m=a.n(s);a(4340);var d={postError:function(){},afterDel:function(){},delAction:function(){}};function l(e){i().extend(!0,this,d,e),this.apiModal=null,this.init()}l.prototype.handleDel=function(e){var t=this;new n.Z({content:"Are you sure that you want to delete the content?",btGhost:{text:"Cancel"},bt:{text:"Delete",callback:function(){t.delAction(e)}}})},l.prototype.init=function(){var e=this;new o.Z({sel:".j_comment_drop",parentScroll:".j_comment_chat",getDropDom:function(e){var t=e.data("ejs")||{},a=m().render(' <div data-hvi class="g_drop" data-align="3-2"> <% if(data.isCanDel) { %> <a href="###" class="j_chat_del" title="Delete this" data-report-eid="qi_A_delete" data-report-uiname="delete" data-report-pdt="chaptercommentlist" data-report-l1="1" data-report-pdid="<%= data.bookId %>" data-report-dt="commentid" data-report-did="<%= data.reviewId %>" data-report-cid="<%= data.chapterId %>">Delete</a> <% } %> <% if(data.isCanReport) { %> <a href="###" class="<% if(!data.isLogin){ %>j_login<% }else{ %> j_chat_abuse<% } %>" title="Report abuse" data-report-eid="qi_A_report" data-report-uiname="report" data-report-pdt="chaptercommentlist" data-report-l1="1" data-report-pdid="<%= data.bookId %>" data-report-dt="commentid" data-report-did="<%= data.reviewId %>" data-report-cid="<%= data.chapterId %>"> Report abuse </a> <% } %> </div> ',{data:t}),r=i()(i().trim(a));return i()("body").append(r),r},onItemClick:function(t,r){if(t.hasClass("j_chat_del"))e.handleDel(r);else if(t.hasClass("j_chat_abuse")){if(t.hasClass(".j_login"))return;Promise.all([a.e(939),a.e(1397)]).then(a.bind(a,4952)).then((function(e){var t=e.default,a=r.data("ejs")||{};new t({bookId:a.bookId,reviewId:a.reviewId,chapterId:a.chapterId,commentType:2})}))}}})};const p=l},1469:(e,t,a)=>{"use strict";a.d(t,{Z:()=>o});var r=a(7113),i=a.n(r);const o=function(e){e.stopPropagation();var t,a=i()(e.currentTarget),r=a.parent(),o=r.find(".j_like_num"),n=parseInt(a.data("rid")),s=o.html()||0;0==g_data.login.statusCode?(a.get(0).checked?(t=1,o.html(parseInt(s)+1),r.attr("data-report-dt",0)):(t=0,o.html(parseInt(s)-1==0?"":parseInt(s)-1),r.attr("data-report-dt",1)),i().ajax({type:"POST",url:"/go/pcm/chapterReview/likeReview",data:{reviewId:n,opType:t},success:function(){}}),e.stopPropagation()):i()(document).data("ApiLogin").showLogin()}},3353:(e,t,a)=>{"use strict";a.d(t,{Z:()=>l});var r=a(7113),i=a.n(r),o=(a(6542),"/go/pcm/chapterReview/addReview"),n={deletedAjax:!1,getCommentListAjax:!1,getCommentReplysAjax:!1},s=function(e,t){n[e]=t},m=function(e){if(n[e])return n[e]};function d(){this.reviewMap={},this.commentLastTimeQueue={},this.commentQueue={},this.reviewReplyLastTimeStore={},this.reviewReplysStore={},this.reviewReplysQueue={},this.commentNumMap={},this.userInfo={isViceModerator:0,userRole:0,isAuthor:0}}d.prototype.addComment=function(e,t,a){var r=this;e&&t&&(r.commentQueue[t]=[],r.addCommentNum(t),a&&r.addReplyNum(a))},d.prototype.getAddUrl=function(){return o},d.prototype.deleteComment=function(e,t,a,r,o,n){if("function"!=typeof n&&(n=function(){}),"function"!=typeof r&&(r=function(){}),"function"!=typeof o&&(o=function(){}),m("deleteAjax"))n();else if(e&&t){var d=this,l={};l.reviewId=t,l.chapterId=e;var p=i().ajax({type:"POST",url:"/go/pcm/chapterReview/deleteReview",data:l,timeout:2e5,success:function(i){try{s("deleteAjax",!1),0===i.code?(d.removeCommentNum(e,t),a&&d.removeReplyNum(e,t,a),r(i)):o(i)}catch(e){console.log(e)}n()},error:function(){try{o({}),n()}catch(e){}s("deleteAjax",!1)}});s("deleteAjax",p)}else n()},d.prototype.requestChapterCommentList=function(e,t,a,r,o,n,d,l){if(m("getCommentListAjax"))l();else if("function"!=typeof l&&(l=function(){}),"function"!=typeof n&&(n=function(){}),"function"!=typeof d&&(d=function(){}),t&&void 0!==r){var p=this,c={bookId:e,chapterId:t,lastReviewId:r,orderType:o,pageIndex:this.getPageIndexChapterId(t)};a&&(c.replyId=a),p.commentQueue[t]||(p.commentQueue[t]=[]),p.commentLastTimeQueue[t]||(p.commentLastTimeQueue[t]=[]);var u=i().ajax({type:"GET",url:"/go/pcm/chapterReview/getReviewList",cache:!1,data:c||{},success:function(e){try{if(0===e.code){var a=e.data&&e.data.chapterReviewItems||[],r=e.data&&e.data.topReview||{},i=e.data&&e.data.topReply||null,o=0;r.reviewId&&(a=[r].concat(a)),i&&(p.reviewMap[i.reviewId]=i),r.topReply=i,a.forEach((function(e){var a=e.reviewId;a&&p.commentQueue[t].indexOf(a)<0&&(p.reviewMap[a]=e,p.commentQueue[t].push(a)),o=a})),o&&p.commentLastTimeQueue[t].push(o),e.data.userInfo&&(p.userInfo=e.data.userInfo),n(e.data)}else d(e)}catch(e){console.log(e)}l(),s("getCommentListAjax",!1)},error:function(){try{d(),l()}catch(e){}s("getCommentListAjax",!1)}});s("getCommentListAjax",u)}else l()},d.prototype.requestChapterCommentReplys=function(e,t,a,r,o,n,d){if(m("getCommentReplysAjax"))d();else if("function"!=typeof d&&(d=function(){}),"function"!=typeof o&&(o=function(){}),"function"!=typeof n&&(n=function(){}),t&&a&&void 0!==r){var l=this,p={bookId:e,chapterId:t,reviewId:a,lastReviewId:r,pageIndex:this.getPageIndexReviewId(a)};l.reviewReplysQueue[a]||(l.reviewReplysQueue[a]=[]),l.reviewReplysStore[a]||(l.reviewReplysStore[a]=[]),l.reviewReplyLastTimeStore[a]||(l.reviewReplyLastTimeStore[a]=[]);var c=i().ajax({type:"GET",url:"/go/pcm/chapterReview/getReviewReplys",cache:!1,data:p||{},success:function(e){try{if(0===e.code){var t=e.data&&e.data.chapterReplyItems||[],r="";t.forEach((function(e){var t=e.reviewId;t&&(l.reviewMap[t]=e,l.reviewReplysQueue[a].indexOf(t)<0&&(l.reviewReplysQueue[a].push(t),l.reviewReplysStore[a].push(t)),r=t)})),l.reviewReplyLastTimeStore[a].push(r),o(e.data)}else n()}catch(e){console.log(e)}d(),s("getCommentReplysAjax",!1)},error:function(){try{n(),d()}catch(e){}s("getCommentReplysAjax",!1)}});s("getCommentReplysAjax",c)}else d()},d.prototype.setChapterCommentNum=function(e,t){e&&t&&!this.commentNumMap[e]&&(this.commentNumMap[e]=t)},d.prototype.getReviewByReviewId=function(e){return this.reviewMap[e]||{}},d.prototype.getCommentQueueByChapterId=function(e){return this.commentQueue[e]||[]},d.prototype.clearCommentQueueByChapterId=function(e){this.commentQueue[e]=[]},d.prototype.resetCommentByChapterId=function(e){this.commentLastTimeQueue[e]=[],this.commentQueue[e]=[]},d.prototype.getLastTimeByChapterId=function(e){return this.commentLastTimeQueue[e]&&this.commentLastTimeQueue[e][this.commentLastTimeQueue[e].length-1]||0},d.prototype.getPageIndexChapterId=function(e){return this.commentLastTimeQueue[e]?this.commentLastTimeQueue[e].length+1:1},d.prototype.addCommentNum=function(e){this.commentNumMap[e]?this.commentNumMap[e]=+this.commentNumMap[e]+1:this.commentNumMap[e]=1},d.prototype.removeCommentNum=function(e,t){var a=this.getReviewByReviewId(t).replyAmount||0;this.getCommentNum(e)>a?this.commentNumMap[e]=this.getCommentNum(e)-a-1:this.commentNumMap[e]=0},d.prototype.getCommentNum=function(e){return this.commentNumMap[e]||0},d.prototype.getReplyQueueByReviewId=function(e){return this.reviewReplysQueue[e]||[]},d.prototype.clearReplyQueueByReviewId=function(e){this.reviewReplysQueue[e]=[]},d.prototype.getLastTimeByReviewId=function(e){return this.reviewReplyLastTimeStore[e]&&this.reviewReplyLastTimeStore[e][this.reviewReplyLastTimeStore[e].length-1]||0},d.prototype.getShowedReviewsNumByReviewId=function(e){return this.reviewReplysStore[e]?this.reviewReplysStore[e].length:0},d.prototype.addReplyNum=function(e){this.reviewMap[e]&&(this.reviewMap[e].replyAmount?this.reviewMap[e].replyAmount=+this.reviewMap[e].replyAmount+1:this.reviewMap[e].replyAmount=1)},d.prototype.removeReplyNum=function(e,t){this.reviewMap[t]&&(this.reviewMap[t].replyAmount>1?this.reviewMap[t].replyAmount=+this.reviewMap[t].replyAmount-1:this.reviewMap[t].replyAmount=0)},d.prototype.resetReviewByReviewId=function(e){this.reviewReplyLastTimeStore[e]=[],this.reviewReplysQueue[e]=[],this.reviewReplysStore[e]=[]},d.prototype.getPageIndexReviewId=function(e){return this.reviewReplyLastTimeStore[e]?this.reviewReplyLastTimeStore[e].length+1:1},d.prototype.getIsAuthor=function(){return 1==+this.userInfo.isAuthor||1==+this.userInfo.isViceModerator},d.prototype.stop=function(){try{m("deletedAjax")&&m("deleteAjax").abort(),m("getCommentListAjax")&&m("getCommentListAjax").abort(),m("getCommentReplysAjax")&&m("getCommentReplysAjax").abort()}catch(e){}this.reviewMap={},this.commentLastTimeQueue={},this.commentQueue={},this.reviewReplyLastTimeStore={},this.reviewReplysStore={},this.reviewReplysQueue={},this.userInfo={isViceModerator:0,userRole:0}};const l=d},2165:e=>{e.exports={NOVEL:0,COMIC:100,PBOOK:200,FANFIC:1}},2268:e=>{e.exports=function(e,t,a){var r,i,o=t.bookId,n=t.coverUpdateTime||t.bookCoverId;if(a=a||150,"local"==e){var s=a?"?width="+a:"";(r=["qidian.gtimg.com/en/images/landing/cover/2x/aoshushenzuo.0.3.jpg"+s,"qidian.gtimg.com/en/images/landing/cover/2x/buxiufanren.0.3.jpg"+s,"qidian.gtimg.com/en/images/landing/cover/2x/dayuzhoushidai.0.2.jpg"+s,"qidian.gtimg.com/en/images/landing/cover/2x/shengxu.0.3.jpg"+s,"qidian.gtimg.com/en/images/landing/cover/2x/yishizhizun.0.2.jpg"+s,"qidian.gtimg.com/en/images/landing/cover/2x/aoshushenzuo.0.3.jpg"+s]).sort((function(){return.5-Math.random()})),i="//dev"+r[1]}else{var m="img.webnovel.com/bookcover/";m="dev"==e||"oa"==e?"//oa"+m:"//"+m;var d=600==(a=a>300?600:150)?"imageMogr2/quality/40":"imageMogr2/quality/80";i=n?m+o+"/"+a+"/"+a+".jpg?coverUpdateTime="+n+"&"+d:m+o+"/"+a+"/"+a+".jpg?"+d}return i}},5389:(e,t,a)=>{var r=a(9713),i=a(2165),o=a(918);e.exports=function(e,t,a,n){var s,m=(r(s={},i.NOVEL,"/book"),r(s,i.COMIC,"/comic"),r(s,i.PBOOK,"/pbook"),r(s,i.FANFIC,"/book"),s),d=m[n]||m[i.NOVEL];return t&&a?d+"/"+(a=o(a))+"_"+t:t?d+"/"+t:"###"}},1558:(e,t,a)=>{var r=a(9713),i=a(918);e.exports=function(e,t,a,o,n,s){var m,d,l=(r(m={},0,"/book"),r(m,100,"/comic"),m);return s||(s=0),t&&a&&o&&n?(o=i(o),n=i(n),d=l[s]+"/"+o+"_"+t+"/"+n+"_"+a):d=t&&a?l[s]+"/"+t+"/"+a:t?l[s]+"/"+t:"###",d}},295:e=>{e.exports=function(e,t,a){var r=!!t;if(!(-1<(e=+e)&&e<6))return"";for(var i=function(e,t,a){return'<input value="'+t+'" type="radio" name="'+e+'" '+(a?'checked="checked"':"")+">"},o=function(a){var r,o,n="";return 0===a?(n=i(t,0,0===e),n+=i(t,1,1===e)):n=i(t,a+1,e===a+1),n+(o='<svg><use xlink:href="#i-star"></use></svg>',"on"===r?'<i class="_on">'+o+"</i>":"<i>"+o+"</i>")},n=function(t){var a,r,i="";return 0<e-t&&e-t<1?i="half":e>t&&(i="on"),r='<use xlink:href="#i-star"></use>',"half"===(a=i)?'<svg class="_half">'+r+"</svg>":"on"===a?'<svg class="_on">'+r+"</svg>":"<svg>"+r+"</svg>"},s=[],m=0;m<5;m++){var d=r?o(m):n(m);s.push(d)}return html='<span class="'+(r?"g_star g_star_edit "+(a||"_disable"):"g_star")+'">'+s.join("")+"</span>",html}},3229:e=>{e.exports=function(e,t,a,r,i){var o="";"local"!=e&&"dev"!=e&&"oa"!=e||(o="oa-");var n="imageMogr2/quality/80";return"//"+o+"user-pic.webnovel.com/userheadimg/"+t+(i?"-"+i:"")+"/"+(a<=30?30:a<=50?50:a<=100?100:a<=200?200:1)+".jpg"+(r?"?uut="+r+"&"+n:"?"+n)}},918:e=>{e.exports=function(e){return encodeURIComponent((e||"").replace(/[;/?:@&=+$,# _\n]+/g,"-").replace(/^(-*)/,"").replace(/(-*)$/,"").toLocaleLowerCase())}},9168:(e,t,a)=>{"use strict";a.d(t,{Z:()=>n});var r=a(7113),i=a.n(r);function o(e){var t=e.data("slideNav");if(t)return t;this.init(e),e.data("slideNav",this)}o.prototype.init=function(e){this.$nav=e,this.$line=e.find("._line");var t=this.$on=e.find("._on");return this.defaultOpt=this.moveTo(t),e.addClass("_slide"),this.events(),this},o.prototype.events=function(){var e=this,t=!1;e.$nav.on("mouseenter","a",(function(){e.moveTo(i()(this)),clearTimeout(t)})).on("mouseleave","a",(function(){t=setTimeout((function(){e.moveTo(e.$nav.find("._on"))}),300)}))},o.prototype.moveTo=function(e){if(!e||!e.length)return!1;var t={width:e.outerWidth(),left:e.position().left};return this.$line.css(t),t};const n=o},4527:(e,t,a)=>{"use strict";var r=a(7113),i=a.n(r),o={$form:!1,isError:!1,watchInput:"input.auto propertychange.auto paste.auto cut.auto",errorSel:"._error",errorCla:"_error",valiWatching:!1,textSel:"textarea",errorTxt:"Reply should not be less than 140 characters",valiSuccess:null};function n(e){e.$form&&(i().extend(!0,this,o,e),this.$error=this.$form.find(this.errorSel),this.$btSub=this.$form.find('button[type="submit"]'),this.$text=this.$form.find(this.textSel),this.init())}n.prototype.init=function(){var e=this,t=e.$form,a=e.$btSub;t.attr("novalidate","novalidate").off("submit.vali").on("submit.vali",(function(r){r.preventDefault(),!e.valiWatching&&e.valiWatch(),"function"==typeof e.valiSuccess&&(a.attr("disabled","disabled"),e.valiSuccess(t))})),e.$text.off(e.watchInput).on(e.watchInput,(function(t){!e.isError&&this.value&&i().trim(this.value)?a.removeAttr("disabled"):a.attr("disabled","disabled")}))},n.prototype.showError=function(e){var t=this,a=t.$btSub;t.$error.text(e),t.$form.addClass(t.errorCla),t.isError=!0,a.removeAttr("disabled")},n.prototype.resetError=function(){var e=this;e.$form.removeClass(e.errorCla),e.isError=!1},n.prototype.valiWatch=function(){var e=this;e.$text.on("focus.vali input.vali blur.vali",(function(){e.resetError()})),e.valiWatching=!0},n.prototype.valiWatchOff=function(){this.$text.off("focus.vali input.vali").off("blur.vali"),this.valiWatching=!1};const s=n;var m=a(1170),d=a(2249),l=(a(9515),{parentsSelector:".m-comment-ft",tplSelector:null,onValiSuccess:function(){},onBeforeAjax:function(e){return e},onSuccess:function(e){(new m.Z).success(e.msg||"success")}});function p(e,t){i().extend(this,l,t,!0),this.$trigger=e,this.init()}p.prototype.ajax=function(e){var t=this,a=d.Z.getFormParams(e.serializeArray()),r=t.onBeforeAjax(a);if(!1!==r){var o=e.find('[type="submit"]'),n=e.attr("method").toUpperCase()||"GET",s=e.attr("action");o.addClass("_loading"),i().ajax({type:n,url:s,cache:!1,data:r,timeout:2e5,success:function(a){0===a.code?!1!==t.onSuccess(a)&&(o.removeClass("_loading"),e[0].reset()):(o.removeClass("_loading"),(new m.Z).error(a.msg||"Something went wrong, please retry later"))},error:function(){o.removeClass("_loading"),(new m.Z).error("Something went wrong, please retry later")}})}},p.prototype.init=function(){var e=this,t=i()(e.tplSelector);if(t.length){var a=t.text();if(a){var r=i()(i().trim(a));e.$trigger.parents(e.parentsSelector).after(r);var o=r.find("textarea").autoTextarea();r.on("reset",(function(){o[0].style.height="32px"})),new s({$form:r,valiSuccess:function(t){e.ajax(t),e.onValiSuccess(t)}})}}},i().fn.reply=function(e){var t=i()(this);return t.data("reply")||t.data("reply",new p(t,e)),t}},6524:(e,t,a)=>{"use strict";var r=a(7113),i=a.n(r),o={$box:null,moreClass:"_readmore",moreSel:null,overClass:"_txtover",moreText:"View More",onClass:"_on"};function n(e){i().extend(this,o,e,!0),this.moreSel||(this.moreSel="."+this.moreClass),this.init()}n.prototype.get$more=function(){var e=this.moreClass,t=this.moreText;return i()('<a href="###" title="'+t+'" class="'+e+'"><svg><use xlink:href="#i-dn"></use></svg></a>')},n.prototype.init=function(){var e=this,t=e.$box;if(!t.length)return!1;t.each((function(){var t=i()(this),a=t.height();if(parseFloat(this.scrollHeight)>a+2){t.addClass(e.overClass);var r=t.find(e.moreSel);r.length||(r=e.get$more(),t.append(r))}})),e.moreSel&&t.off("click.dotdotdot").on("click.dotdotdot",e.moreSel,(function(t){t.preventDefault();var a=i()(this).parent(),r=a[0].scrollHeight;a.css("maxHeight",r+"px").addClass(e.onClass)}))},i().fn.rowsEll=function(e){return i()(this).each((function(){i()(this).data("rowsEll")||((e=e||{}).$box=i()(this),i()(this).data("rowsEll",new n(e)))}))}},7677:(e,t,a)=>{"use strict";a.d(t,{Z:()=>h});var r=a(6336),i=a(7113),o=a.n(i),n=a(2271),s=o()(window).height(),m=o()(window).width(),d="data-exposure-report",l={selector:"["+d+"]",repeatSelector:"[data-exposure-repeat]",onShow:""},p=function(e){var t=e.node,a=e.parentNode,r=void 0===a?null:a;if(!t)return!1;if(!t.getBoundingClientRect)return!1;var i=t.getBoundingClientRect(),o=i.width||t.offsetWidth,n=i.height||t.offsetHeight;if(0==o||0==n)return!1;if(r){var d=r.getBoundingClientRect(),l=r.width||r.offsetWidth,p=r.height||tparentNode.offsetHeight,c=d.top<=i.top&&d.top+p>=i.top+n;return d.left<=i.left&&d.right+l>=i.right+o&&c}var u=i.top>=0&&i.top<=s-.5*n;return i.left>=0&&i.left<=m-.5*o&&u},c=function(e){var t=e.node,a=e.parentNode,r=void 0===a?null:a,i=t.getBoundingClientRect(),o=i.width||t.offsetWidth,n=i.height||t.offsetHeight;if(0==o||0==n)return!0;if(r){var d=r.getBoundingClientRect(),l=r.width||r.offsetWidth,p=r.height||r.offsetHeight,c=d.top<=i.top&&d.top+p>=i.top+n;return!(d.left<=i.left&&d.right+l>=i.right+o&&c)}var u=i.top>=0&&(i.top+n<=0||i.top<s);return!(i.left>=0&&(i.left+o<=0||i.left<m)&&u)};function u(e,t){o().extend(!0,this,l,{parent:e?o()(l.selector).parents(e).get(0):null,scrollWrap:t?o()(l.selector).parents(t).get(0):null}),this.init()}u.prototype.nodeList=[],u.prototype.init=function(){this.checkPosition();var e=this;this.parent&&this.scrollWrap?this.scrollWrap.addEventListener("scroll",(0,r.Z)((function(){e.checkPosition()}),100,100)):window.addEventListener("scroll",(0,r.Z)((function(){e.checkPosition()}),100,100))},u.prototype.isInScreen=function(e){return p({node:e,parenNode:this.parent})},u.prototype.isNotInScreen=function(e){return c({node:e,parenNode:this.parent})},u.prototype.checkPosition=function(){var e=null;this.nodeList=o()(this.selector);for(var t=0,a=this.nodeList.length;t<a;t++)(e=this.nodeList[t])&&this.isInScreen(e)&&(this.sendReport(e),e.removeAttribute(d));this.repeatNodeList=o()(this.repeatSelector).not(this.selector);for(var r=0,i=this.repeatNodeList.length;r<i;r++){var n=this.repeatNodeList[r];n&&this.isNotInScreen(n)&&n.setAttribute(d,"")}},u.prototype.sendReport=function(e){n.Z.send({target:e},{ltype:"C"},!0)},u.isInScreen=p,u.isNotInScreen=c;const h=u},9515:(e,t,a)=>{"use strict";var r=a(7113),i=a.n(r),o={watchInput:"input.height propertychange.height paste.height cut.height"};function n(e,t){if(!e.length)return!1;i().extend(!0,this,o,t),this.$it=e,this.init()}n.prototype.init=function(){var e=this,t=e.$it;e.autoHeight(t),t.off(e.watchInput).on(e.watchInput,(function(){e.autoHeight(t)}))},n.prototype.autoHeight=function(e){e.css({height:0}).css({height:e[0].scrollHeight})},i().fn.autoTextarea=function(e){var t=i()(this);return t.data("autoTextarea")||t.data("autoTextarea",new n(t,e)),t}},2249:(e,t,a)=>{"use strict";a.d(t,{Z:()=>o});var r=a(7113),i=a.n(r);const o={getFormParams:function(e){var t={};return i().each(e,(function(){t[this.name]?(t[this.name].push||(t[this.name]=[t[this.name]]),t[this.name].push(i().trim(this.value)||"")):t[this.name]=i().trim(this.value)||""})),t}}},2043:(e,t,a)=>{"use strict";var r=a(7113),i=a.n(r),o={};function n(e,t){if(!e.length)return!1;i().extend(!0,this,o,t||{}),this.$it=e,this.init()}n.prototype.init=function(){var e=this.$it;e.addClass("g_loading_box"),e.children(".g_loading").length||e.append('<span class="g_loading _auto"><i></i></span>')},n.prototype.loading=function(){this.$it.addClass("_loading")},n.prototype.unloading=function(){this.$it.removeClass("_loading")},i().fn.loadingBox=function(e){var t=i()(this);return t.data("loadingBox")||t.data("loadingBox",new n(t,e)),t}},6336:(e,t,a)=>{"use strict";a.d(t,{Z:()=>r});const r=function(e,t,a){var r,i=new Date;return function(){var o=this,n=arguments,s=new Date;clearTimeout(r),s-i>=a?(e.apply(o,n),i=s):r=setTimeout(e,t)}}},4748:(e,t,a)=>{"use strict";a.d(t,{Z:()=>r});const r=' <% if(data && data.items && data.items.length) { %> <% for(var i=0; i<data.items.length; i++ ) { %> <% var commentItem = data.items[i];  %> <%\n  var userHomeUrl = getUserHomeUrl(commentItem.userId, commentItem.appId);\n  var userAvatar= getUserAvatar(env, commentItem.userId, 88, commentItem.coverId, commentItem.appId);\n  var userName = getUserName(commentItem.userRole, commentItem.userName, commentItem.penName);\n  var topReply = commentItem.topReply||null;\n  var commentInfo= JSON.stringify({\n      bookId: data.bookId,\n      chapterId: data.chapterId,\n      reviewId: commentItem.reviewId,\n      lastTime: commentItem.createTime\n  });\n\n  /* 渲染 Index 需要的数据 */\n  var dataHeader= {\n    userName: userName,\n    href: userHomeUrl,\n    userLevel: commentItem.userLevel,\n    isViceModerator: commentItem.isViceModerator,\n    role: commentItem.userRole,\n    badgeInfo:{\n      url: commentItem.holdBadgeCoverURL,\n      updateTime: commentItem.holdBadgeCoverId\n    }\n  };\n\n  var userRoleLabel=function(role,isVice){\n    var roleType={\n      0: \'user\',\n      1: \'author\',\n      2: \'translator\'\n    };\n    if(isVice){\n      return "vicemoderator";\n    }\n    return roleType[role];\n  };\n%> <section class="m-comment j_comment_wrap <% if(+commentItem.replyAmount >= 0){ %>j_chapter_comment_main<% } %> j_review_del_<%= commentItem.reviewId%>" data-ejs="<%= commentInfo %>"> <% if(commentItem.isLikedByAuthor){ %> <p class="m-comment-author-like fs12 mb8 lh16 c_warning pr"> <svg class="w16 h16 fs16 pa t0 r100%" width="20" height="20"> <use xlink:href="#i-lovefill"></use> </svg> Author has liked this comment. </p> <% } %> <div class="clearfix"> <% var userReportAttr="data-report-eid=qi_A_heads data-report-uiname=heads data-report-did="+commentItem.userId+" data-report-dt="+userRoleLabel(commentItem.userRole, commentItem.isViceModerator); %> <a rel="" class="g_avatar bc_default w28 h28 br100% dib vam oh fl mr16" href="<%= userHomeUrl %>" title="<%= userName %>" <%=userReportAttr %>> <img cross-origin="anonymous" class="db w100% h100% br100%" width="28" height="28" src="<%= userAvatar %>" alt="<%= userName %>"> </a> <div class="oh"> <% var dataHeader= dataHeader; %> <div class="m-comment-hd lh20 clearfix mb8"> <% if(dataHeader.isHot) { %> <svg class="w20 h20 fr ml8 _hot c_danger" width="20" height="20"> <use xlink:href="#i-hot"></use> </svg> <% } %> <div class="oh"> <div class="dib m-comment-hd-mn vat"> <div class="fr ml8 fs0"> <% if(dataHeader.role > 0 || dataHeader.isViceModerator) { %> <strong class="g_role _<%= dataHeader.isViceModerator?"vice_moderator":dataHeader.role %> mr4"></strong> <% } %> <% if(dataHeader.userLevel) { %> <strong title="Level <%= dataHeader.userLevel %>" class="g_lv _<%= dataHeader.userLevel %> mr4">LV <%= dataHeader.userLevel %></strong> <% } %> <% if(dataHeader.badgeInfo && dataHeader.badgeInfo.updateTime) { %> <% var badgeSrcTag = dataHeader.lazyload ? \'data-original\':\'src\'; %> <img class="vam" <%= badgeSrcTag %>="<%= dataHeader.badgeInfo.url %>40.png?mt=<%= dataHeader.badgeInfo.updateTime %>" width="12" height="12" alt="Badge"/> <% } %> <% if(dataHeader.subText){ %> <small class="fs16 c_s"><%- dataHeader.subText %></small> <% } %> </div> <h3 class="db ell fs16"> <a href="<%= userHomeUrl %>" title="<%= dataHeader.userName %>" class="c_l" <%=userReportAttr %>> <%= dataHeader.userName %> </a> </h3> </div> <% if(dataHeader.titleExtra){ %> <%- dataHeader.titleExtra %> <% } %> </div> <% if(dataHeader.extra){ %> <small class="fs12 c_s dib mt4"><%- dataHeader.extra %></small> <% } %> </div> <div class="m-comment-bd g_txt_over fs16 lh24 <%= isReward? \'c_primary\' : \'\' %>"> <%\n            var isReward = commentItem.commentType === 2 ? true: false;\n            var replyContent = formatCommentContent(commentItem.content);\n          %> <%- replyContent %> </div> <% if(commentItem.imageItems && commentItem.imageItems.length > 0){ %> <%\n      var imageConfig  = {\n        imageUrl: commentItem.imageItems[0].imageUrl || \'\',\n        width: commentItem.imageItems[0].width || \'\',\n        height: commentItem.imageItems[0].height || \'\',\n        dataSrc: commentItem.imageItems[0].imageUrl || \'\'\n      };\n      %> <%\n  var width= imageConfig.width;\n  var height= imageConfig.height;\n  var ratio=width/height;\n  var imgType=0;\n  var attrStyle="";\n  if(ratio<0.5){\n    imgType=1;\n  }else if(ratio<1){\n    imgType=2;\n    attrStyle=\'style=width:\'+140*width/height+\'px;\';\n  }else if(ratio===1){\n    imgType=3;\n  }else if(ratio<2){\n    imgType=4;\n    attrStyle=\'style=height:\'+140*height/width+\'px;\';\n  }else{\n    imgType=5;\n  }\n%> <figure data-hvi data-src="<%= imageConfig.imageUrl %>" class="m-comment-img j_show_img dib vat oh pr m0 p0 cp _<%= imgType %>" <%= attrStyle %> data-report-eid="qi_A_image" data-report-uiname="image" data-report-dt="commentid" data-report-did="<%= commentItem.reviewId %>"> <img cross-origin="anonymous" class="db w100% h100%" src="<%= imageConfig.imageUrl %>?imageMogr2/thumbnail/280x280|imageMogr2/strip" width="<%= imageConfig.width %>" height="<%=imageConfig.height  %>" alt="img"> </figure> <% } %> <%\n      var imageURl = "";\n      if(commentItem.pImageItems && commentItem.pImageItems.length > 0){\n        imageURl = commentItem.pImageItems[0].imageUrl;\n      }\n      %> <% var quoteUserName=getUserName(commentItem.pUserRole, commentItem.pUserName, commentItem.pPenName); %> <% if(commentItem.pContent||imageURl) { %> <% if(+commentItem.pStatus===1) { %> <blockquote class="m-comment-qt br16 pt12 pb12 pl16 pr16 fs14 c_m db"> <% if(quoteUserName){ %> <strong class="db fw700 ell mb4"><%= quoteUserName %>:</strong> <% } %> <% if(commentItem.pContent){ %> <span class="m-comment-qt-bd db ells _2 g_txt_over"><%- formatCommentContent(commentItem.pContent) %></span> <% } %> <% if(imageURl){ %> <a href="###" data-src="<%= imageURl %>" title="view image" class="fs12 lh20 vat ttu fw700 dib mt4 j_show_img" data-report-eid="qi_A_image" data-report-uiname="image" data-report-dt="commentid" data-report-did="<%= commentItem.pReviewId %>"> <svg class="w20 h20 vat" width="20" height="20"> <use xlink:href="#i-img"></use> </svg> view image </a> <% } %> </blockquote> <% } else { %> <blockquote class="m-comment-qt br16 pt12 pb12 pl16 pr16 fs14 c_m db" disabled="disabled"> The content has been deleted </blockquote> <% } %> <% } %> <div class="m-comment-ft clearfix"> <strong class="fl c_m fs12 lh24"><%= commentItem.createTimeFormat%></strong> <span class="fr m-comment-tools fs0"> <label data-hvi class="g_good m-comment-tool" data-report-uiname="likes" data-report-eid="qi_A_likes" data-report-dt="<%=commentItem.isLiked? 0:1 %>" data-report-did="<%= commentItem.reviewId %>"> <input type="checkbox" class="j_comment_good <%if(statusCode != 0){ %>j_login<% } %>" data-rid="<%= commentItem.reviewId %>" <%if(commentItem.isLiked){ %> checked="checked" <% } %> > <strong class="vam"> <svg> <use xlink:href="#i-good-on"></use> </svg> <svg> <use xlink:href="#i-good"></use> </svg> </strong> <span class="j_like_num vam"><%= commentItem.likeAmount || \'\' %></span> </label> <a data-isauthor="<%= isAuthor %>" title="reply" href="###" class="m-comment-tool <%if(statusCode != 0){ %>j_login<% }else{ %>j_chapter_reply<% } %>" data-userName="<%= userName %>" data-rid="<%= commentItem.reviewId%>" data-report-eid="qi_A_replyreviews" data-report-uiname="replyreviews" data-report-dt="replyid" data-report-did="<%= commentItem.reviewId %>"> <svg> <use xlink:href="#i-say"></use> </svg> </a> <%\n            var isSelf= statusCode == 0 && user.userId == commentItem.userId;\n            var isCanDel= isAuthor || isSelf;\n            var isCanReport = isAuthor || !isSelf;\n            var objDrop={\n              bookId: data.bookId,\n              guid: commentItem.userId,\n              reviewId: commentItem.reviewId,\n              chapterId: data.chapterId,\n              isCanDel: isCanDel,\n              isCanReport: isCanReport,\n              isLogin: statusCode == 0\n            };\n          %> <a href="#tplChapterDrop" title="More" class="m-comment-tool j_comment_drop" data-rid="<%= commentItem.reviewId %>" data-ejs="<%= JSON.stringify(objDrop); %>" data-report-eid="qi_A_set" data-report-uiname="set"> <svg> <use xlink:href="#i-det"></use> </svg> </a> </span> </div> <% if( typeof commentItem.replyAmount !== "undefined" ){ %> <div class="j_more_replies_body"> <% if(topReply){ %> <%\n  var userHomeUrl = getUserHomeUrl(topReply.userId, topReply.appId);\n  var userAvatar= getUserAvatar(env, topReply.userId, 88, topReply.coverId, topReply.appId);\n  var userName = getUserName(topReply.userRole, topReply.userName, topReply.penName);\n  var commentInfo= JSON.stringify({\n      bookId: data.bookId,\n      chapterId: data.chapterId,\n      reviewId: topReply.reviewId,\n      lastTime: topReply.createTime\n  });\n\n  var dataHeader={\n    userName: userName,\n    href: userHomeUrl,\n    userLevel: topReply.userLevel,\n    isViceModerator: topReply.isViceModerator,\n    role: topReply.userRole,\n    badgeInfo:{\n      url: topReply.holdBadgeCoverURL,\n      updateTime: topReply.holdBadgeCoverId\n    }\n  };\n  var userRoleLabel=function(role,isVice){\n    var roleType={\n      0: \'user\',\n      1: \'author\',\n      2: \'translator\'\n    };\n    if(isVice){\n      return "vicemoderator";\n    }\n    return roleType[role];\n  };\n%> <section class="m-comment j_comment_wrap j_review_del_<%= topReply.reviewId%>" data-ejs="<%= commentInfo %>"> <% if(topReply.isLikedByAuthor){ %> <p class="m-comment-author-like fs12 mb8 lh16 c_warning pr"> <svg class="w16 h16 fs16 pa t0 r100%" width="20" height="20"> <use xlink:href="#i-lovefill"></use> </svg> Author has liked this comment. </p> <% } %> <div class="clearfix"> <% var userReportAttr="data-report-eid=qi_A_heads data-report-uiname=heads data-report-did="+topReply.userId+" data-report-dt="+userRoleLabel(topReply.userRole, topReply.isViceModerator); %> <a rel="" class="g_avatar bc_default w28 h28 br100% dib vam oh fl mr16" href="<%= userHomeUrl %>" title="<%= userName %>" <%= userReportAttr%>> <img cross-origin="anonymous" class="db w100% h100% br100%" width="28" height="28" src="<%= userAvatar %>" alt="<%= userName %>"> </a> <div class="oh"> <% var dataHeader= dataHeader; %> <div class="m-comment-hd lh20 clearfix mb8"> <% if(dataHeader.isHot) { %> <svg class="w20 h20 fr ml8 _hot c_danger" width="20" height="20"> <use xlink:href="#i-hot"></use> </svg> <% } %> <div class="oh"> <div class="dib m-comment-hd-mn vat"> <div class="fr ml8 fs0"> <% if(dataHeader.role > 0 || dataHeader.isViceModerator) { %> <strong class="g_role _<%= dataHeader.isViceModerator?"vice_moderator":dataHeader.role %> mr4"></strong> <% } %> <% if(dataHeader.userLevel) { %> <strong title="Level <%= dataHeader.userLevel %>" class="g_lv _<%= dataHeader.userLevel %> mr4">LV <%= dataHeader.userLevel %></strong> <% } %> <% if(dataHeader.badgeInfo && dataHeader.badgeInfo.updateTime) { %> <% var badgeSrcTag = dataHeader.lazyload ? \'data-original\':\'src\'; %> <img class="vam" <%= badgeSrcTag %>="<%= dataHeader.badgeInfo.url %>40.png?mt=<%= dataHeader.badgeInfo.updateTime %>" width="12" height="12" alt="Badge"/> <% } %> <% if(dataHeader.subText){ %> <small class="fs16 c_s"><%- dataHeader.subText %></small> <% } %> </div> <h3 class="db ell fs16"> <a href="<%= userHomeUrl %>" title="<%= dataHeader.userName %>" class="c_l" <%= userReportAttr%>> <%= dataHeader.userName %> </a> </h3> </div> <% if(dataHeader.titleExtra){ %> <%- dataHeader.titleExtra %> <% } %> </div> <% if(dataHeader.extra){ %> <small class="fs12 c_s dib mt4"><%- dataHeader.extra %></small> <% } %> </div> <div class="m-comment-bd g_txt_over fs16 lh24 <%= isReward? \'c_primary\' : \'\' %>"> <%\n            var isReward = topReply.commentType === 2 ? true: false;\n            var replyContent = formatCommentContent(topReply.content);\n          %> <%- replyContent %> </div> <% if(topReply.imageItems && topReply.imageItems.length > 0){ %> <%\n      var imageConfig  = {\n        imageUrl: topReply.imageItems[0].imageUrl || \'\',\n        width: topReply.imageItems[0].width || \'\',\n        height: topReply.imageItems[0].height || \'\',\n        dataSrc: topReply.imageItems[0].imageUrl || \'\'\n      };\n      %> <%\n  var width= imageConfig.width;\n  var height= imageConfig.height;\n  var ratio=width/height;\n  var imgType=0;\n  var attrStyle="";\n  if(ratio<0.5){\n    imgType=1;\n  }else if(ratio<1){\n    imgType=2;\n    attrStyle=\'style=width:\'+140*width/height+\'px;\';\n  }else if(ratio===1){\n    imgType=3;\n  }else if(ratio<2){\n    imgType=4;\n    attrStyle=\'style=height:\'+140*height/width+\'px;\';\n  }else{\n    imgType=5;\n  }\n%> <figure data-hvi data-src="<%= imageConfig.imageUrl %>" class="m-comment-img j_show_img dib vat oh pr m0 p0 cp _<%= imgType %>" <%= attrStyle %> data-report-eid="qi_A_image" data-report-uiname="image" data-report-dt="commentid" data-report-did="<%= topReply.reviewId %>"> <img cross-origin="anonymous" class="db w100% h100%" src="<%= imageConfig.imageUrl %>?imageMogr2/thumbnail/280x280|imageMogr2/strip" width="<%= imageConfig.width %>" height="<%=imageConfig.height  %>" alt="img"> </figure> <% } %> <%\n      var  imageURl = "";\n      if(topReply.pImageItems && topReply.pImageItems.length>0){\n        imageURl = topReply.pImageItems[0].imageUrl;\n      }\n      %> <% var quoteUserName=getUserName(topReply.pUserRole, topReply.pUserName, topReply.pPenName); %> <% if(topReply.pContent||imageURl) { %> <% if(+topReply.pStatus===1) { %> <blockquote class="m-comment-qt br16 pt12 pb12 pl16 pr16 fs14 c_m db"> <% if(quoteUserName){ %> <strong class="db fw700 ell mb4"><%= quoteUserName %>:</strong> <% } %> <% if(topReply.pContent){ %> <span class="m-comment-qt-bd db ells _2 g_txt_over"><%- formatCommentContent(topReply.pContent) %></span> <% } %> <% if(imageURl){ %> <a href="###" data-src="<%= imageURl %>" title="view image" class="fs12 lh20 vat ttu fw700 dib mt4 j_show_img" data-report-eid="qi_A_image" data-report-uiname="image" data-report-dt="commentid" data-report-did="<%= topReply.pReviewId %>"> <svg class="w20 h20 vat" width="20" height="20"> <use xlink:href="#i-img"></use> </svg> view image </a> <% } %> </blockquote> <% } else { %> <blockquote class="m-comment-qt br16 pt12 pb12 pl16 pr16 fs14 c_m db" disabled="disabled"> The content has been deleted </blockquote> <% } %> <% } %> <div class="m-comment-ft clearfix"> <strong class="fl c_m fs12 lh24"><%= topReply.createTimeFormat%></strong> <span class="fr m-comment-tools fs0"> <label data-hvi class="g_good m-comment-tool" data-report-uiname="likes" data-report-eid="qi_A_likes" data-report-dt="<%=topReply.isLiked? 0:1 %>" data-report-did="<%= topReply.reviewId %>"> <input type="checkbox" class="j_comment_good <%if(statusCode != 0){ %>j_login<% } %>" data-rid="<%= topReply.reviewId%>" <%if(topReply.isLiked){ %> checked="checked" <% } %>> <strong class="vam"> <svg> <use xlink:href="#i-good-on"></use> </svg> <svg> <use xlink:href="#i-good"></use> </svg> </strong> <span class="j_like_num vam"><%= topReply.likeAmount || \'\' %></span> </label> <a data-isauthor="<%= isAuthor %>" title="reply" href="###" class="m-comment-tool j_chapter_reply <%if(statusCode != 0){ %>j_login<% } %>" data-userName="<%= userName %>" data-rid="<%= topReply.reviewId%>" data-report-eid="qi_A_replyreviews" data-report-uiname="replyreviews" data-report-dt="replyid" data-report-did="<%= topReply.reviewId %>"> <svg> <use xlink:href="#i-say"></use> </svg> </a> <%\n            var isSelf= statusCode == 0 && user.userId == topReply.userId;\n            var isCanDel= isAuthor || isSelf;\n            var isCanReport = isAuthor || !isSelf;\n            var objDrop={\n              bookId: data.bookId,\n              guid: topReply.userId,\n              reviewId: topReply.reviewId,\n              topReplyId: topReply.reviewId,\n              chapterId: data.chapterId,\n              isCanDel: isCanDel,\n              isCanReport: isCanReport,\n              isLogin: statusCode == 0\n            };\n          %> <a href="#tplChapterDrop" title="More" class="m-comment-tool j_comment_drop" data-rid="<%= topReply.reviewId %>" data-ejs="<%= JSON.stringify(objDrop); %>" data-report-eid="qi_A_set" data-report-uiname="set"> <svg> <use xlink:href="#i-det"></use> </svg> </a> </span> </div> </div> </div> </section> <% } %> </div> <a href="###" class="m-comment-reply-btn fs12 fw600 lh20 ttu mb16 c_m mb16 j_get_more_replies <%= +commentItem.replyAmount >0?"db":"dn" %>" title="view replies" data-report-eid="qi_A_morereplyreviews" data-report-uiname="morereplyreviews"> <svg class="w20 h20 c_xs" width="20" height="20"> <use xlink:href="#i-reply-fill"></use> </svg> <strong class="vam dib">view <%= commentItem.replyAmount %> replies</strong> </a> <% } %> </div> </div> </section> <% } %> <% } else if(lastTime === 0 && from === "review") { %> <p class="tac pt32 pb32 c_s fs14 lh16">No comment</p> <% } else if(lastTime === 0 && from === ""){ %> <p class="tac pt32 pb32 c_s fs14 lh16"><i class="img_emptylist"></i><br/><span class="fwb fs16 lh24">Be the first comment!<br/> Grab it before anyone takes it.</span></p> <% } %> '}}]);